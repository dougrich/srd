/*
Copyright (c) 2016 Douglas Richardson
*/
!function(e){function n(e){function n(e,n){var t=new XMLHttpRequest;t.onload=function(){200!==this.status?n(this.status,this.responseText):n(null,this.responseText)},t.onerror=function(){n(i.errCouldntFetchFile)},t.open("GET",e),t.send()}function t(e,n){var t=u.transaction([a.tbname],"readwrite").objectStore(a.tbname).get(e);t.onsuccess=function(e){e.target.result?n(null,e.target.result.body):n(a.cacheMiss,null)}}function o(e,n,t){e||u.transaction([a.tbname],"readwrite").objectStore(a.tbname).add({name:n.file,body:t})}function r(n){return function(t,o){e({id:n.id,err:t,result:o})}}function s(){for(;d.length;)!function(e){var s=r(e);null===u?n(e.file,s):t(e.file,function(t,r){t===a.cacheMiss?n(e.file,function(n,t){s(n,t),o(n,e,t)}):s(t,r)})}(d.pop())}var a={version:2,dbname:"__offline-loader-db",tbname:"_resources",cacheMiss:"Missed Cache",processorInterval:100},i={errDbNotCreatedSuccessfully:"IndexedDB not created successfully",errCouldntFetchFile:"Unable to fetch the file"},c=window._indexedDB||window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,l=c.open(a.dbname,a.version),u=null,d=[];return l.onupgradeneeded=function(e){var n=e.target.result,t=n.createObjectStore(a.tbname,{keyPath:"name"});t.createIndex("name","name",{unique:!0}),t.transaction.oncomplete=function(e){u=n,setInterval(s,a.processorInterval)}},l.onsuccess=function(e){u=e.target.result,setInterval(s,a.processorInterval)},l.onerror=function(e){u=null,setInterval(s,a.processorInterval),console.error(i.errDbNotCreatedSuccessfully)},function(e){d.push(e.data)}}if(window){var t=window.offline||(window.offline={});t._fallback=n(function(e){t._fallbackPost({data:e})})}else self.onmessage=n(function(e){self.postMessage(e)})}(window||self);
/*
Copyright (c) 2016 Douglas Richardson
*/
!function(r,a){function n(r,a){if(Array.isArray(r))for(var n=[],e=[],i=0,o=!1,l=0;l<r.length;l++)n.push(null),e.push(null),function(l){var c=d++;t[c]=function(d,t){i++,(n[l]=d)&&(o=!0),e[l]=t,i===r.length&&a(o?d:null,e)},f({id:c,file:r[l]})}(l);else{var c=d++;t[c]=a,f({id:c,file:r})}}var e={errorUninitialized:"Offline Loader Error: worker thread is not initialized",errorUnwatched:"Missing a callback handler for: "},i={workerScript:"/src/offline-async-worker.js"};a=a||{};for(var o in i)a[o]=a[o]||i[o];var l=null,d=0,t={},f=null;r._fallback?(f=function(a){r._fallback({data:a})},r._fallbackPost=function(r){t[r.data.id]?(t[r.data.id](r.data.err,r.data.result),delete t[r.data.id]):console.error(e.errorUnwatched+r.data.id)}):(l=new Worker(a.workerScript),l.onmessage=function(r){t[r.data.id]?(t[r.data.id](r.data.err,r.data.result),delete t[r.data.id]):console.error(e.errorUnwatched+r.data.id)},f=function(r){l.postMessage(r)}),r.load=n}(window.offline||(window.offline={}),window.offlineConfig||(window.offlineConfig=null));